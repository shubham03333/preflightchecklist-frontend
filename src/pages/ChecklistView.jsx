import React, { useEffect, useState } from 'react';
import { getChecklist, updateItem, deleteItem } from '../api';
import { useParams, Link } from 'react-router-dom';
export default function ChecklistView(){ const {id}=useParams(); const [data,setData]=useState(null); const load=async()=>{ try{ const d=await getChecklist(id); setData(d); }catch(e){ console.error(e); } }; useEffect(()=>{ load(); },[id]); if(!data) return <div>Loading...</div>; const toggle=async(it)=>{ await updateItem(it.id,{status: it.status==='Completed'?'Pending':'Completed'}); load(); }; return (<div><div className="card mb-4"><div className="flex justify-between items-start"><div><h2 className="text-2xl font-semibold">{data.flight_number}</h2><div className="text-sm text-gray-500">{data.date}</div></div><div className="flex gap-2 items-center"><Link to={`/${id}/edit`} className="text-orange-500">Edit</Link></div></div></div><div className="card"><h3 className="font-semibold mb-3">Checks</h3><div className="space-y-2">{data.items.map(it=>(<div key={it.id} className="flex justify-between items-center p-3 border rounded"><div><div className="font-medium">{it.check_text}</div><div className="text-sm text-gray-500">{it.comment}</div></div><div className="flex gap-2 items-center"><button onClick={()=>toggle(it)} className="px-3 py-1 rounded bg-green-600 text-white">{it.status}</button><button onClick={async()=>{ if(confirm('Delete item?')){ await deleteItem(it.id); load(); }}} className="px-3 py-1 rounded bg-red-600 text-white">Delete</button></div></div>))}</div></div></div>); }
